#include "util.h"
#include <string.h>

const mask_idx MASK_IDXs[11]={{2,{0,0,-1,-1}},{2,{1,1,-1,-1}}, {2,{0,1,-1,-1}},{2,{0,1,-1,-1}},{2,{0,1,-1,-1}},{2,{0,1,-1,-1}},{1,{0,-1,-1,-1}},{1,{0,-1,-1,-1}},{1,{1,-1,-1,-1}},{1,{1,-1,-1,-1}},{4,{0,0,1,1}}};

const mask_idx PACKET_IDXs[11]={{2,{1,2,-1,-1}},{2,{3,4,-1,-1}}, {2,{1,3,-1,-1}},{2,{1,4,-1,-1}},{2,{2,3,-1,-1}},{2,{2,4,-1,-1}},{1,{1,-1,-1,-1}},{1,{2,-1,-1,-1}},{1,{3,-1,-1,-1}},{1,{4,-1,-1,-1}},{4,{1,2,3,4}}};


const uint32_t IP_MASKS[33] = {0,(uint32_t)((uint32_t)1 <<  (uint32_t)31),~((1 << (32 - 2)) - 1),~((1 << (32 - 3)) - 1),~((1 << (32 - 4)) - 1),~((1 << (32 - 5)) - 1),~((1 << (32 - 6)) - 1),~((1 << (32 - 7)) - 1),~((1 << (32 - 8)) - 1),~((1 << (32 - 9)) - 1),~((1 << (32 - 10)) - 1),~((1 << (32 - 11)) - 1),~((1 << (32 - 12)) - 1),~((1 << (32 - 13)) - 1),~((1 << (32 - 14)) - 1),~((1 << (32 - 15)) - 1),~((1 << (32 - 16)) - 1),~((1 << (32 - 17)) - 1),~((1 << (32 - 18)) - 1),~((1 << (32 - 19)) - 1),~((1 << (32 - 20)) - 1),~((1 << (32 - 21)) - 1),~((1 << (32 - 22)) - 1),~((1 << (32 - 23)) - 1),~((1 << (32 - 24)) - 1),~((1 << (32 - 25)) - 1),~((1 << (32 - 26)) - 1),~((1 << (32 - 27)) - 1),~((1 << (32 - 28)) - 1),~((1 << (32 - 29)) - 1),~((1 << (32 - 30)) - 1),~((1 << (32 - 31)) - 1),~((1 << (32 - 32)) - 1)};

const uint32_t PORT_MASKS[17]={~((1 << (32 - (32-(16-0)))) - 1),~((1 << (32 - (32-(16-1)))) - 1),~((1 << (32 - (32-(16-2)))) - 1),~((1 << (32 - (32-(16-3)))) - 1),~((1 << (32 - (32-(16-4)))) - 1),~((1 << (32 - (32-(16-5)))) - 1),~((1 << (32 - (32-(16-6)))) - 1),~((1 << (32 - (32-(16-7)))) - 1),~((1 << (32 - (32-(16-8)))) - 1),~((1 << (32 - (32-(16-9)))) - 1),~((1 << (32 - (32-(16-10)))) - 1),~((1 << (32 - (32-(16-11)))) - 1),~((1 << (32 - (32-(16-12)))) - 1),~((1 << (32 - (32-(16-13)))) - 1),~((1 << (32 - (32-(16-14)))) - 1),~((1 << (32 - (32-(16-15)))) - 1),~((1 << (32 - (32-(16-16)))) - 1)}; 

const uint32_t *MASK_TABLE[2]={IP_MASKS,PORT_MASKS};
const uint32_t MODE_SIZES[11] = {(4*sizeof(uint32_t)),(4*sizeof(uint32_t)),(4*sizeof(uint32_t)),
		      (4*sizeof(uint32_t)),(4*sizeof(uint32_t)),(4*sizeof(uint32_t)),
			   (2*sizeof(uint32_t)),(2*sizeof(uint32_t)),(2*sizeof(uint32_t)),(2*sizeof(uint32_t)),(8*sizeof(uint32_t))};
const int DIMS[11] = {2,2,2,2,2,2,1,1,1,1,4};
const max_prefs MAX_PREFIXES[11] = {{32,32,-1,-1},{16,16,-1,-1},{32,16,-1,-1},{32,16,-1,-1},{32,16,-1,-1},{32,16,-1,-1},{32,-1,-1,-1},{32,-1,-1,-1}, {16,-1,-1,-1},{16,-1,-1,-1},{32,32,16,16}};

const MODE INT_TO_MODE[11]={SIDI,SPDP,
             SISP,SIDP,
             DISP,DIDP,
             SI,DI,
             SP,DP,
             FULL};

extern inline uint32_t ip4_str_int_be(const char *str);
extern inline uint32_t ip4_str_int_le(const char *str);
extern inline int split(char **dst, char **src, char *str);
extern inline void int_le_to_str(uint32_t value,  char *str);

